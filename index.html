<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="description" content="A comprehensive notepad app with notes, todos, and more">
    <title>NotePad Pro</title>
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <!-- Added icon links for iOS and general favicon support -->
    <link rel="icon" type="image/jpeg" href="/icon-192.jpg">
    <link rel="apple-touch-icon" href="/icon-192.jpg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NotePad Pro">
</head>
<body class="font-medium">
    <!-- Lock Screen -->
    <div class="lock-screen" id="lockScreen">
        <div class="lock-content">
            <div class="lock-icon">
                <i class="bi bi-lock-fill"></i>
            </div>
            <h2 class="lock-title">App Locked</h2>
            <p class="lock-subtitle">Enter your PIN to unlock</p>
            <div class="pin-input">
                <input type="password" maxlength="1" class="pin-digit" id="pin1">
                <input type="password" maxlength="1" class="pin-digit" id="pin2">
                <input type="password" maxlength="1" class="pin-digit" id="pin3">
                <input type="password" maxlength="1" class="pin-digit" id="pin4">
            </div>
            <button class="btn btn-primary" onclick="unlockApp()">Unlock</button>
            <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                Default PIN: 1234
            </p>
        </div>
    </div>

    <!-- Header -->
    <header class="app-header">
        <div class="header-left">
            <button class="hamburger-btn" onclick="toggleSidebar()">
                <i class="bi bi-list"></i>
            </button>
            <h1 class="app-title">NotePad Pro</h1>
        </div>
        <div class="header-actions">
            <button class="icon-btn" onclick="searchNotes()" title="Search">
                <i class="bi bi-search"></i>
            </button>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">Menu</h2>
            <button class="close-sidebar" onclick="toggleSidebar()">
                <i class="bi bi-x"></i>
            </button>
        </div>
        <ul class="sidebar-menu">
            <li onclick="showTab('notes')">
                <i class="bi bi-journal-text"></i>
                <span>My Notes</span>
            </li>
            <li onclick="showTab('todos')">
                <i class="bi bi-check2-square"></i>
                <span>To-Do List</span>
            </li>
            <li onclick="showTab('settings')">
                <i class="bi bi-gear"></i>
                <span>Settings</span>
            </li>
            <li onclick="exportData()">
                <i class="bi bi-download"></i>
                <span>Export Data</span>
            </li>
            <li onclick="importData()">
                <i class="bi bi-upload"></i>
                <span>Import Data</span>
            </li>
            <li onclick="showAbout()">
                <i class="bi bi-info-circle"></i>
                <span>About</span>
            </li>
        </ul>
    </aside>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeAll()"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="notes" onclick="showTab('notes')">
                <i class="bi bi-journal-text"></i> Notes
            </button>
            <button class="tab-btn" data-tab="todos" onclick="showTab('todos')">
                <i class="bi bi-check2-square"></i> To-Do
            </button>
            <button class="tab-btn" data-tab="settings" onclick="showTab('settings')">
                <i class="bi bi-gear"></i> Settings
            </button>
        </div>

        <!-- Notes Tab -->
        <div class="tab-content" id="notesTab">
            <div class="notes-grid" id="notesGrid">
                <!-- Notes will be dynamically added here -->
            </div>
            <div class="empty-state" id="emptyNotes" style="display: none;">
                <i class="bi bi-journal-plus"></i>
                <h3>No notes yet</h3>
                <p>Tap the + button to create your first note</p>
            </div>
        </div>

        <!-- Todos Tab -->
        <div class="tab-content" id="todosTab" style="display: none;">
            <ul class="todo-list" id="todoList">
                <!-- Todos will be dynamically added here -->
            </ul>
            <div class="empty-state" id="emptyTodos" style="display: none;">
                <i class="bi bi-check2-square"></i>
                <h3>No tasks yet</h3>
                <p>Tap the + button to add your first task</p>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settingsTab" style="display: none;">
            <div class="settings-group">
                <h3 class="settings-title">Appearance</h3>
                
                <div class="setting-item">
                    <div>
                        <div class="setting-label">Dark Mode</div>
                        <div class="setting-description">Switch between light and dark theme</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div>
                        <div class="setting-label">Font Size</div>
                        <div class="setting-description">Adjust text size</div>
                    </div>
                    <select class="select-control" id="fontSizeSelect" onchange="changeFontSize()">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                        <option value="xlarge">Extra Large</option>
                    </select>
                </div>
            </div>

            <div class="settings-group">
                <h3 class="settings-title">Security</h3>
                
                <div class="setting-item">
                    <div>
                        <div class="setting-label">App Lock</div>
                        <div class="setting-description">Require PIN to open app</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="appLockToggle" onchange="toggleAppLock()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div>
                        <div class="setting-label">Change PIN</div>
                        <div class="setting-description">Update your security PIN</div>
                    </div>
                    <button class="btn btn-secondary" onclick="changePIN()">Change</button>
                </div>
            </div>

            <div class="settings-group">
                <h3 class="settings-title">Notifications</h3>
                
                <div class="setting-item">
                    <div>
                        <div class="setting-label">Todo Reminders</div>
                        <div class="setting-description">Get notified for tasks</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notificationsToggle" checked onchange="toggleNotifications()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-group">
                <h3 class="settings-title">Data</h3>
                
                <div class="setting-item">
                    <div>
                        <div class="setting-label">Clear All Data</div>
                        <div class="setting-description">Delete all notes and settings</div>
                    </div>
                    <button class="btn btn-danger" onclick="clearAllData()">Clear</button>
                </div>
            </div>
        </div>
    </main>

    <!-- FAB Button -->
    <button class="fab-btn" id="fabBtn" onclick="openCreateModal()">
        <i class="bi bi-plus-lg"></i>
    </button>

    <!-- Note Modal -->
    <div class="modal" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">New Note</h3>
                <button class="close-modal" onclick="closeNoteModal()">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="noteForm">
                    <input type="hidden" id="noteId">
                    
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" id="noteTitle" placeholder="Enter note title" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Content</label>
                        <textarea class="form-control" id="noteContent" placeholder="Write your note here..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Background Color</label>
                        <div class="color-picker-group">
                            <div class="color-option selected" style="background-color: transparent; border: 2px solid var(--border-color);" data-color="transparent"></div>
                            <div class="color-option" style="background-color: #fef3c7;" data-color="#fef3c7"></div>
                            <div class="color-option" style="background-color: #dbeafe;" data-color="#dbeafe"></div>
                            <div class="color-option" style="background-color: #fce7f3;" data-color="#fce7f3"></div>
                            <div class="color-option" style="background-color: #dcfce7;" data-color="#dcfce7"></div>
                            <div class="color-option" style="background-color: #f3e8ff;" data-color="#f3e8ff"></div>
                            <div class="color-option" style="background-color: #ffedd5;" data-color="#ffedd5"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Add Image</label>
                        <input type="file" class="form-control" id="noteImage" accept="image/*" onchange="previewImage()">
                        <img id="imagePreview" class="image-preview" style="display: none;">
                    </div>

                    <div class="form-group">
                        <label class="toggle-switch" style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="noteLock">
                            <span class="toggle-slider"></span>
                            <span class="form-label" style="margin: 0;">Lock this note</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeNoteModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveNote()">Save Note</button>
            </div>
        </div>
    </div>

    <!-- Todo Modal -->
    <div class="modal" id="todoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">New Task</h3>
                <button class="close-modal" onclick="closeTodoModal()">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="todoForm">
                    <input type="hidden" id="todoId">
                    
                    <div class="form-group">
                        <label class="form-label">Task</label>
                        <input type="text" class="form-control" id="todoText" placeholder="Enter task" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Reminder Date & Time</label>
                        <input type="datetime-local" class="form-control" id="todoTime">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTodoModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveTodo()">Save Task</button>
            </div>
        </div>
    </div>

    <!-- Note Detail Modal -->
    <div class="modal" id="noteDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Note Details</h3>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="icon-btn" onclick="editNoteFromDetail()" title="Edit">
                        <i class="bi bi-pencil"></i>
                    </button>
                    <button class="icon-btn" onclick="shareNoteFromDetail()" title="Share">
                        <i class="bi bi-share"></i>
                    </button>
                    <button class="close-modal" onclick="closeNoteDetailModal()">
                        <i class="bi bi-x"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="note-detail" id="noteDetailContent">
                    <!-- Note details will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Hidden file input for import -->
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport()">

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>

    <!-- Main JavaScript -->
    <script src="app.js"></script>
</body>
</html>
